</<!DOCTYPE html>
<html lang="en" dir="ltr">
<!--
A basic WYSIWYG editor for generating JSON files containing page title
and HTML contents, to be saved in the appropriate directory for compilation
into the final web page.

As the maintainer of a simple site, it's still nice to use a text editor
instead of writing markup. This could also be hosted online for a use by a non-
technical content writer. Additional data fields can be easily added.

Note: If this code is ever put online it should only be accessed by authorized
users unless the proper changes are made to the build file to sanitize content.
 -->
<head>
  <meta charset="utf-8">
  <title>Simple Site CMS</title>
  <style>
    * {font-family: sans-serif;}
    body {padding:10%;}
    #title {margin: 4px 0px 15px 0px; width: 100%; height: 30px;}
    #save {margin-top: 10px;}
  </style>
</head>

<body>
  <!-- Quill Stylesheet -->
  <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
  <h1>Simple Site CMS</h1>
  <label for="title">Post Title</label><br>
  <input type="text" id="title"/>
  <!-- Create the editor container -->
  <div id="editor"></div>
  <a id="save"><button>Save</button></a>

  <!-- Include Quill library -->
  <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
  <!-- Instantiate Quill editor and save callback -->
  <script>
    var quill = new Quill('#editor', {
      theme: 'snow'
    });
    // On text change, create downloadable json blob, attach to save button url
    quill.on('text-change', function(delta, oldDelta, source) {
      var title = document.getElementById('title').value;
      var content = quill.root.innerHTML;
      var blob = new Blob(
        [JSON.stringify({'title': title, 'content': content })],
        {type: "application/json"}
       );
      // create downloadable link
      var url = window.URL.createObjectURL(blob);
      var anchor = document.getElementById("save");
      anchor.href = url;
      anchor.download = "content.json";
    });

  </script>

</body>

</html>
